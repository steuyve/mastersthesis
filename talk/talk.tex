\documentclass[12pt]{beamer}
 
% Define  CWRU specific color schemes
\definecolor{cwrublue}{RGB}{10,48,78}
\definecolor{cwrugrey}{RGB}{106,106,106}
%---------------------------------------

\mode<presentation>
{
  \usetheme{Boadilla}
  % \usecolortheme{dolphin}
  % Font themes
  \usefonttheme{serif}

  \setbeamercolor{palette primary}{bg=cwrublue,fg=white}
  \setbeamercolor{palette secondary}{bg=cwrublue,fg=white}
  \setbeamercolor{palette tertiary}{bg=cwrublue,fg=white}
  \setbeamercolor{palette quaternary}{bg=cwrublue,fg=white}
  \setbeamercolor{structure}{fg=cwrublue} % itemize, enumerate, etc
  \setbeamercolor{section in toc}{fg=cwrublue} % TOC sections

  % Override palette coloring with secondary
  \setbeamercolor{subsection in head/foot}{bg=cwrugrey,fg=white}
  % or ...

  %\setbeamercovered{transparent}
  % or whatever (possibly just delete it)
}

\usepackage[english]{babel}
% or whatever
\usepackage{mathptmx}
%\usepackage[latin1]{inputenc}
% or whatever

\usepackage{times}
\usepackage[T1]{fontenc}
% Or whatever. Note that the encoding and the font should match. If T1
% does not look nice, try deleting the line with the fontenc.

\title[Magnitude of odd-dimensional Euclidean balls]{On the asymptotic behavior of the magnitude function for odd-dimensional Euclidean balls}
\subtitle{Master's Thesis}

\author % (optional, use only with lots of authors)
{Stephen Shang Yi Liu}
% - Give the names in the same order as the appear in the paper.
% - Use the \inst{?} command only if the authors have different
%   affiliation.

\institute[CWRU] % (optional, but mostly needed)
{Department of Mathematics, Applied Mathematics and Statistics\and
Case Western Reserve University}
% - Use the \inst command only if there are several affiliations.
% - Keep it simple, no one is interested in your street address.

\date{March 19, 2020} % (optional, should be abbreviation of conference name)

% - Either use conference name or its abbreviation.
% - Not really informative to the audience, more for people (including
%   yourself) who are reading the slides online

\subject{Mathematics, Applied Mathematics and Statistics}
% This is only inserted into the PDF information catalog. Can be left
% out. 

% If you have a file called "university-logo-filename.xxx", where xxx
% is a graphic format that can be processed by latex or pdflatex,
% resp., then you can add a logo as follows:

%\pgfdeclareimage[height=0.5cm]{university-logo}{cwru-logo}
%\logo{\pgfuseimage{university-logo}}

% Delete this, if you do not want the table of contents to pop up at
% the beginning of each subsection:
%\AtBeginSubsection[]
%{
%  \begin{frame}<beamer>{Outline}
%    \tableofcontents[currentsection,currentsubsection]
%  \end{frame}
%}

% If you do not wish to uncover everything in a step-wise fashion, uncomment
% the following command: 

%\beamerdefaultoverlayspecification{<+->}

\setbeamertemplate{theorems}[numbered]


\AtBeginSection[]
{
	\begin{frame}
		\frametitle{Table of Contents}
		\tableofcontents[currentsection]
	\end{frame}
}

\usepackage[arrow]{xypic}
\usepackage{tikz}

\begin{document}

\begin{frame}
  \titlepage
  \transboxin
\end{frame}

\begin{frame}{Table of Contents}
	\tableofcontents
\end{frame}

\section{Introduction to magnitude}

\begin{frame}{Notions of size}
\begin{itemize}
\item Cardinality of a set
\item Measure of a set
\item Order of a group
\item Volume
\item Euler characteristic of a topological space
\end{itemize}
\end{frame}

\begin{frame}{Origins in category theory}
\begin{itemize}
\item Leinster in \cite{leinster_euler_2006} defines the Euler characteristic of a finite category.
\item This definition is extended to finite enriched categories.
\item Lawvere in \cite{lawvere_metric_1973} observed that categories enriched in $[0,\infty]$ can be seen as metric spaces.
\item Definition of Euler characteristic for finite categories enriched in $[0,\infty]$ gives the definition of the magnitude of a finite metric space. 
\end{itemize}
\end{frame}

\begin{frame}[allowframebreaks]{Magnitude of a matrix}

\begin{definition}
Let $M \in M_n(\mathbb{R})$ be a $n\times n$ matrix. A \textbf{weighting} on $M$ is a column vector $w\in\mathbb{R}^n$ such that $Mw = 1$. A \textbf{coweighting} on $M$ is a row vector $v\in\mathbb{R}^n$ such that $vM = 1^\ast$.
\end{definition}

\framebreak

\begin{lemma}
Suppose $A$ possesses a weighting $w$ and a coweighting $v$. Then $\sum\limits_{j=1}^n w_j = \sum\limits_{j=1}^n v_j$.
\end{lemma}

\begin{proof}
\begin{equation*}
\sum\limits_{j=1}^nw_j = 1^\ast w = vMw = v1 = \sum\limits_{j=1}^nv_j.
\end{equation*}
\end{proof}

\framebreak

\begin{definition}
Let $M \in M_n(\mathbb{R})$. If $M$ possesses a weighting $w$ and coweighting $v$, then we say $M$ has \textbf{magnitude} and its magnitude is given by
\begin{equation*}
\vert M \vert = \sum\limits_{j=1}^nw_j = \sum\limits_{j=1}^nv_j.
\end{equation*}
\end{definition}

The weighting of a matrix is not guaranteed to exist, and even if it does, it is not clear how to compute it. But if the matrix is invertible, then the calculation is more straightforward, as the following lemma shows.

\framebreak

\begin{lemma}\label{lem:invertible}
If $M$ is invertible, then $M$ possesses a unique weighting and its magnitude is given by
\begin{equation*}
\vert M \vert = \sum\limits_{i,j=1}^n\left[M^{-1}\right]_{ij}.
\end{equation*}
\end{lemma}

\framebreak

\begin{proof}
Suppose $M$ is invertible. Then the equation $Mw = 1$
has
\begin{equation*}
w_j = \left[M^{-1}1\right]_j = \sum\limits_{i=1}^n m^{(j)}_i
\end{equation*}
where $m^{(j)}$ is the $j$-th row of $M^{-1}$, as the unique solution. Then the magnitude of $M$ is given by
\begin{equation*}
\vert M \vert = \sum\limits_{j=1}^n w_j = \sum\limits_{j=1}^n\sum\limits_{i=1}^n \left[M^{-1}\right]_{ij}.
\end{equation*}
\end{proof}

\end{frame}

\begin{frame}[allowframebreaks]{Finite metric spaces}

\begin{definition}
Let $A$ be a finite metric space with distance matrix $d$. Define its \textbf{similarity matrix} $Z_A$ by
\begin{equation*}
\left[Z_A\right]_{a,b} = e^{-d(a,b)}.
\end{equation*}
Then if $Z_A$ has magnitude, then we say $A$ has \textbf{magnitude} and we write
\begin{equation*}
\vert A \vert = \vert Z_A \vert.
\end{equation*}
\end{definition}

\framebreak

\begin{example}
\setbeamertemplate{enumerate items}[square]
\begin{enumerate}
\item Let $A$ be the discrete space, that is, for all $a\neq b \in A$, $d(a,b) = \infty$. Let $A$ have $n$ points. Then the similarity matrix of $A$ is $I_n$, the $n\times n$ identity matrix, and the magnitude $\vert A \vert = n$.
\item Let $A$ consist of two points of distance $d$ apart. Then
\begin{equation*}
Z_A = \begin{bmatrix} 1 & e^{-d} \\ e^{-d} & 1 \end{bmatrix}
\end{equation*}
and by Lemma \ref{lem:invertible} above, the magnitude of $A$ is $\vert A \vert = 1 + \tanh\left(\frac{d}{2}\right)$.
\end{enumerate}
\end{example}

\end{frame}

\begin{frame}[allowframebreaks]{The magnitude function}

Want to consider the magnitude of a space as we scale distances.

\begin{definition}
Let $t > 0$. Denote by $tA$ the metric space containing the same points as $A$ but all distances are scaled by $t$. Then we call the assignment $t\mapsto\vert tA\vert$ the \textbf{magnitude function} of $A$.
\end{definition}

Note that $Z_{tA}$ might not possess a weighting for all $t$, so the magnitude function might only be a partially defined function of $t$.

\framebreak

\begin{example}
Recalling the second example above, suppose $A$ has two points of distance $d$ apart. Then
\begin{equation*}
Z_{tA} = \begin{bmatrix} 1 & e^{-td} \\ e^{-td} & 1 \end{bmatrix}
\end{equation*}
and the magnitude function is
\begin{equation*}
\text{Mag}(tA) = 1 + \tanh\left(\frac{td}{2}\right).
\end{equation*}
\end{example}

\begin{theorem}[Proposition 2.2.6 of \cite{leinster_magnitude_2011}]
Let $A$ be a finite metric space. Then
\begin{itemize}
\item $tA$ is invertible and hence has magnitude for all but finitely many $t > 0$.
\item The magnitude function of $A$ is analytic at all $t>0$ such that $tA$ is invertible.
\item for $t \gg 0$, there is a unique, positive, weighting on $tA$.
\item For $t \gg 0$, the magnitude function of $A$ is increasing.
\item $\vert tA \vert \to \#A$ as $t \to \infty$.
\end{itemize}
\end{theorem}

\begin{proof}[Idea of proof]\renewcommand{\qedsymbol}{}
As $t\to\infty$, the similarity matrix $Z_{tA} \to I_n$.
\end{proof}

\framebreak

\begin{example}
Let $K_{3,2}$ denote the bipartite graph of 3 and 2 vertices with each edge having distance $t$ and using the shortest-path metric.
\begin{columns}
\begin{column}{0.45\textwidth}
\begin{figure}
\begin{equation*}
\begin{xy}
(0,0)*+{\bullet_{a_1}}="a1";
(0,-10)*+{\bullet_{a_2}}="a2";
(0,-20)*+{\bullet_{a_3}}="a3";
(30,-5)*+{\bullet_{b_1}}="b1";
(30,-15)*+{\bullet_{b_2}}="b2";
{\ar@{-} "a1";"b1"}?*!/_3mm/{t};
{\ar@{-} "a2";"b1"};
{\ar@{-} "a3";"b1"};
{\ar@{-} "a1";"b2"};
{\ar@{-} "a2";"b2"};
{\ar@{-} "a3";"b2"};
\end{xy}
\end{equation*}
\caption{\label{fig:K32}The graph $K_{3,2}$.}
\end{figure}
\end{column}
\begin{column}{0.50\textwidth}
Then the magnitude function of $K_{3,2}$ is given by:
\begin{equation*}
\text{Mag}\left(tK_{3,2}\right) = \frac{5-7e^{-t}}{(1+e^{-t})(1-2e^{-2t})}.
\end{equation*}
\end{column}
\end{columns}
\end{example}
\end{frame}

\begin{frame}[plain]
\begin{figure}
\includegraphics[width=10cm]{K32.eps}\caption{\label{fig:K32magfun}The magnitude function of $K_{3,2}$.}
\end{figure}
\end{frame}

\begin{frame}[allowframebreaks]{Positive definite metric spaces}
For what kinds of spaces does magnitude behave more nicely?

\begin{definition}
A finite metric space $A$ is called \textbf{positive definite} if its similarity matrix $Z_{A}$ is a positive definite matrix.
\end{definition}

\begin{itemize}
\item Positive definite matrices are always invertible, so any positive definite metric space automatically has magnitude.
\item Principal submatrices of positive definite matrices are positive definite so subspaces of positive definite metric spaces also have magnitude.
\item Finite subsets of Euclidean space are positive definite metric spaces.
\end{itemize}

\framebreak

\begin{theorem}[Proposition 2.4.3 of \cite{leinster_magnitude_2011}]\label{thm:variational}
If $A$ is a finite positive definite metric space of $n$ points, then $A$ has magnitude and the magnitude is given by
\begin{equation*}
\vert A \vert = \sup\limits_{v\neq0}\frac{\left(\sum_{a\in A}v_a\right)^2}{v^\ast Z_{A}v}
\end{equation*}
where $v \in \mathbb{R}^n$. The supremum is attained if and only if $v$ is a nonzero scalar multiple of the unique weighting on $A$.
\end{theorem}

\begin{proof}[Idea of proof]\renewcommand{\qedsymbol}{}
Cauchy-Schwarz inequality applied to arbitrary $v$ and weighting $w$.
\end{proof}

\begin{theorem}[Lemma 2.4.10 of \cite{leinster_magnitude_2011}]\label{thm:subspace}
If $A$ is a positive definite metric space and $B \subseteq A$, then $\vert B \vert \leq \vert A \vert$.
\end{theorem}

\begin{proof}
Since $A$ is positive definite and $B$ is a subspace, $B$ is also positive definite and both sapces have magnitude. Furthermore, using Theorem \ref{thm:variational} above, we have
\begin{equation*}
\vert B \vert = \sup\limits_{v\neq0}\frac{\left(\sum_{b \in B} v_b\right)^2}{v^\ast Z_{B} v} \leq \sup\limits_{v\neq0}\frac{\left(\sum_{a \in A} v_a\right)^2}{v^\ast Z_{B} v} = \vert A \vert
\end{equation*}
since the space of vectors we are considering for $B$ is a subspace of the space of vectors in consideration for $A$.
\end{proof}

\end{frame}

\begin{frame}[allowframebreaks]{Infinite metric spaces}
\begin{itemize}
\item Want to extend the definition of magnitude to include infinite sets.
\item Idea: approximate by finite subsets.
\item Question: Is the answer we get via approximation by finite subspaces independent of the approximation we choose?
\item Answer: Yes, for a specific class of metric spaces.
\end{itemize}

\framebreak

\begin{definition}
Let $A$ be a metric space. We say $A$ is a \textbf{positive definite metric space} if every finite subspace of $A$ is positive definite. If $A$ has the property that $tA$ is positive definite for all $t > 0$, then $A$ is of \textbf{negative type}.
\end{definition}

\begin{itemize}
\item Negative type is a classical property from metric space theory.
\item Many familiar metric spaces are of negative type and we will see later that they have magnitude.
\end{itemize}

\framebreak

\begin{definition}[The Hausdorff metric]
Let $X$ be a metric space and $A,B$ be compact subsets. Then $d_H(A,B)$, the \textbf{Hausdorff distance} between $A,B$ is defined to be
\begin{equation*}
d_H(A,B) = \max\left\{\sup\limits_{a \in A} d(a,B), \sup\limits_{b \in B} d(A,b)\right\}.
\end{equation*}
\end{definition}

\framebreak

\begin{definition}[Gromov-Hausdorff distance]
Let $A,B$ be compact metric spaces. Then $d_{GH}(A,B)$ the Gromov-Hausdorff distance between $A,B$ is defined to be
\begin{equation*}
d_{GH}(A,B) = \inf d_H(\varphi(A),\psi(B))
\end{equation*}
where the infimum is over all metric spaces $X$ and isometric embeddings $\varphi: A \to X$ and $\psi: B \to X$.
\end{definition}

\framebreak

\begin{theorem}[Proposition 3.1 of \cite{leinster_magnitude_2017}]
The quantity
\begin{equation*}
M(A) = \sup\{\vert A'\vert : A' \subseteq A, \text{$A'$ finite}\}
\end{equation*}
is a lower semicontinuous function of $A$ (taking values in $[0,\infty]$) in the class of compact positive definite metric spaces equipped with the Gromov-Hausdorff topology.
\end{theorem}

\begin{itemize}
\item Note that if $A$ is a finite positive definite metric space, then by semicontinuity and Theorem \ref{thm:subspace}, $M(A) = \vert A \vert$, so this agrees with the finite case.
\end{itemize}

\framebreak

\begin{definition}
Let $A$ be a compact positive definite metric space. Then the \textbf{magnitude} of $A$, written $\vert A \vert$, is the value of the supremum $M(A)$ above.
\end{definition}

\framebreak

Here are some examples of metric spaces that are of negative type and hence their compact and finite subspaces have magnitude:

\begin{example}
\setbeamertemplate{enumerate items}[square]
\begin{enumerate}
\item $\ell_p^n$ for $n \geq 1$ and $1\leq p \leq 2$,
\item $L_p[0,1]$ for $1 \leq p \leq 2$,
\item $n$-spheres with the geodesic distance (\cite{willerton_magnitude_2014}).
\item weighted trees.
\end{enumerate}
\end{example}

\end{frame}

\section{Odd-dimensional Euclidean balls}

\begin{frame}[allowframebreaks]{The convex magnitude conjecture}

Computer calculations by Leinster and Willerton in \cite{leinster_asymptotic_2013} led to what became known as the convex magnitude conjecture. It has since been shown to be false, but it, along with various asymptotic versions of the conjecture, motivates many of the results in this section.

\begin{definition}
Let $\mathcal{K}^n$ be the space of compact convex sets in $\mathbb{R}^n$. A nonempty set in $\mathcal{K}^n$ is called a \textbf{convex body}. A function $P:\mathcal{K}^n \to \mathbb{R}$ is called a \textbf{valuation} if
\begin{itemize}
\item $P(\emptyset) = 0$,
\item $P(A\cup B) = P(A) + P(B) - P(A\cap B)$, where $A,B, A\cup B \in \mathcal{K}^n$.
\end{itemize}
\end{definition}

\framebreak

\begin{theorem}[Hadwiger's Theorem (\cite{schneider_convex_2014})]
If $P:\mathcal{K}^n \to \mathbb{R}$ is invariant under rigid motions and continuous with respect to the Hausdorff metric, then there are valuations $V_0,V_1,\dots,V_n$ where each $V_i$ is homogenous of degree $i$, and constants $c_0,c_1,\dots,c_n$ such that
\begin{equation*}
P = \sum\limits_{i=0}^n c_i V_i.
\end{equation*}
\end{theorem}

\begin{itemize}
\item Each $V_i$ is called the $i$-th intrinsic volume.
\item $V_n$ is the usual $n$-dimensional volume, $V_{n-1}$ is half the surface area, and $V_0$ is the Euler characteristic.
\end{itemize}

\framebreak

Leinster and Willerton in \cite{leinster_asymptotic_2013} stated the following conjecture.

\begin{block}{Convex magnitude conjecture}
Let $K \in \mathcal{K}^n$. Then magnitude is a valuation and moreover
\begin{equation*}
\text{Mag}(tK) = \sum\limits_{i\geq0}\frac{V_i(K)}{i!\omega_i}t^i
\end{equation*}
where $\omega_i$ is the volume of the $i$-th dimensional unit ball.
\end{block}

\framebreak

Barcelo and Carbery explicitly calculated the magnitude function for odd-dimensional Euclidean balls, showing that the magnitude function is a \emph{rational} function in $t$:

\begin{theorem}[\cite{barcelo_magnitudes_2016}]
Let $d$ be odd and denote by $B_2^d$ the closed $d$-dimensional Euclidean ball. Then
\begin{align*}\label{eqn:explicitmagfuns}
&\text{Mag}\left(tB_2^3\right) = \frac{t^3}{3!}+t^2+2t+1, \\
&\text{Mag}\left(tB_2^5\right) = \frac{t^6+18t^5+135t^4+525t^3+1080t^2+1080t+360}{5!(t+3)}. \\
\end{align*}
\end{theorem}

\begin{itemize}
\item In particular, the magnitude function for $B_2^5$ shows that the convex magnitude conjecture is in general false.
\item However, various asymptotic versions of the convex magnitude conjecture (with somewhat different coefficients) have been shown.
\end{itemize}

\end{frame}

\begin{frame}[allowframebreaks]{Asymptotic results}

\begin{theorem}[Theorem 1 of \cite{barcelo_magnitudes_2016}]\label{thm:BCasymp}
Let $K$ be a nonempty compact set in $\mathbb{R}^n$. Then
\begin{equation*}
\text{Mag}(tK) \to 1 \text{ as $t\to0$}
\end{equation*}
and
\begin{equation*}
t^{-n}\text{Mag}(tK) \to \frac{\text{Vol}(K)}{n!\omega_n} \text{ as $t\to\infty$.}
\end{equation*}
\end{theorem}
So the first and last coefficients were correctly predicted by the conjecture as we take $t\to0$ and $t\to\infty$ respectively.

\framebreak

\begin{theorem}[Theorem 2(c)-(d) of \cite{gimperlein_magnitude_2017}]\label{thm:GGasymp}
Let $d\geq3$ be odd and let $K$ be a $d$-dimensional convex body with nonempty interior and smooth boundary. Then
\begin{align*}
\text{Mag}(tK) &= \frac{1}{d!\omega_d}\left(V_d(K)t^d+(d+1)V_{d-1}(K)t^{d-1}\right. \\
&\qquad \left.+\frac{\pi}{4}(d+1)^2V_{d-2}(K)t^{d-2}\right)+O\left(t^{d-3}\right)
\end{align*}
as $t\to\infty$.
\end{theorem}
So we can recover the next two intrinsic volumes in the asymptotic expansion for large $t$, but the coefficients are not the ones predicted by the convex magnitude conjecture.

\framebreak

\begin{theorem}[Theorem 4 of \cite{meckes_magnitude_2019}]\label{thm:meckesasymp}
Let $d=2m+1$ be odd and denote by $B_2^d$ the $d$-dimensional closed Euclidean ball. Then
\begin{equation*}
\frac{d}{dt}\text{Mag}\left(tB_2^d\right)\big\vert_{t=0} = \frac{1}{2}V_1\left(B_2^d\right)
\end{equation*}
where
\begin{equation*}
V_1\left(B_2^d\right) = \frac{(2m+1)\sqrt{\pi}\Gamma\left(m+1\right)}{\Gamma\left(m+\frac{3}{2}\right)} = 2\binom{m-\frac{1}{2}}{m}^{-1}
\end{equation*}
is the first intrinsic volume of the closed unit ball.
\end{theorem}

\begin{itemize}
\item This result depends on work done by Willerton in \cite{willerton_magnitude_2017} to reformulate the magnitude function of odd-dimensional Euclidean balls in terms of collections of Schröder paths.
\end{itemize}

\end{frame}

\section{Schröder paths}

\begin{frame}[allowframebreaks]{Schröder paths}

\begin{definition}
\begin{itemize}
\item A \textbf{Schröder path} is a finite directed path in the integer lattice in which each step starting at $(x,z) \in \mathbb{Z}^2$ is either an \textbf{ascent} to $(x+1,y+1)$, a \textbf{descent} to $(x+1,y-1)$ or a \textbf{flat step} to $(x+2,y)$.
\item Fix $k\geq0$. A \textbf{disjoint $k$-collection} is a family of Shröder paths from $(-i,i)$ to $(i,i$ for each $0\leq i \leq k$ such that no node in $\mathbb{Z}^2$ is contained in more than one path.
\item We denote by $X_k$ the set of all disjoint $k$-collections and by $X_k^j$ the sete of all disjoint $k$-collections containing exactly $j$ flat steps.
\end{itemize}
\end{definition}

\framebreak

\begin{itemize}
\item What does $X_k^0$ look like? Starting from $i = 0$ and moving up we realize that each path at height $i$ can only consist of $i$ ascents followed by $i$ descents. We will call this kind of path a \textbf{V-path at height $i$}. 
\item The set $X_k^0$ consists of only one collection, which we'll call $\sigma_{\text{roof}}^k$, which is entirely made up of V-paths for each $0\leq i \leq k$.
\end{itemize}

\framebreak

Let $\sigma \in X_k$ be a disjoint $k$-collection. For each path in $\sigma$ we associate to each step $\tau$ a weighting by
\begin{equation*}
\omega_j(\tau) = \begin{cases}
1 &\text{if $\tau$ is an ascent}, \\
t &\text{if $\tau$ is a flat step}, \\
y+1-j &\text{if $\tau$ is a descent from height $y$ to height $y-1$}.
\end{cases}
\end{equation*}

For a collection $\sigma \in X_k$ the \textbf{total weight} of $\sigma$, denoted $\omega_j(\sigma)$ is the product of the weightings of all the steps on each path in $\sigma$. So $\omega_j(\sigma)$ is a polynomial in $t$ with degree the maximum number of flat steps in $\sigma$.

\framebreak

\begin{figure}[h!]
\begin{equation*}
\begin{tikzpicture}[scale=0.75]
\foreach \i in {0,...,6}
	\foreach \j in {0,...,6}{
		\draw (\i,\j) circle(1pt);
	};
	
	% 0 level
	\node at (3,0) [circle, fill, inner sep=1pt]{};
	
	% 1 level
	\node at (2,1) [circle, fill, inner sep=1pt]{};
	\node at (4,1) [circle, fill, inner sep=1pt]{};
	\node at (3,2) [circle, fill, inner sep=1pt]{};
	\draw (2,1) -- (3,2);
	\draw (4,1) -- node[above] {1} (3,2);
	
	% 2 level
	\node at (1,2) [circle, fill, inner sep=1pt]{};
	\node at (2,3) [circle, fill, inner sep=1pt]{};
	\node at (3,4) [circle, fill, inner sep=1pt]{};
	\node at (4,3) [circle, fill, inner sep=1pt]{};
	\node at (5,2) [circle, fill, inner sep=1pt]{};
	\draw (1,2) -- (2,3) -- (3,4);
	\draw (3,4) -- node[above] {3} (4,3);
	\draw (4,3) -- node[above] {2} (5,2);
	
	% 3 level
	\node at (0,3) [circle, fill, inner sep=1pt]{};
	\node at (1,4) [circle, fill, inner sep=1pt]{};
	\node at (2,5) [circle, fill, inner sep=1pt]{};
	\node at (3,6) [circle, fill, inner sep=1pt]{};
	\node at (4,5) [circle, fill, inner sep=1pt]{};
	\node at (5,4) [circle, fill, inner sep=1pt]{};
	\node at (6,3) [circle, fill, inner sep=1pt]{};
	\draw (0,3) -- (1,4) -- (2,5) -- (3,6);
	\draw (3,6) -- node[above] {5} (4,5);
	\draw (4,5) -- node[above] {4} (5,4);
	\draw (5,4) -- node[above] {3} (6,3);
\end{tikzpicture}
\end{equation*}
\caption{\label{fig:Vpath} The disjoint 3-collection $\sigma^3_\text{roof}$ with $\omega_2$ weightings.}
\end{figure}

\framebreak

\begin{theorem}[Corollary 27 of \cite{willerton_magnitude_2017}]\label{thm:willerton}
Let $d = 2m+1$ be odd. Then
\begin{equation*}
\text{Mag}\left(tB_2^d\right) = \frac{\sum\limits_{\sigma\in X_{m+1}}\omega_2(\sigma)}{d!\sum\limits_{\sigma \in X_{m-1}}\omega_0(\sigma)} =: \frac{N(t)}{d!D(t)}
\end{equation*}
for all $t>0$.
\end{theorem}
Meckes proved his result in Theorem \ref{thm:meckesasymp} by differentiating the expression above, evaluating at zero and simplifying.

\end{frame}

\section{The problem}

\begin{frame}[allowframebreaks]{The problem}

\begin{block}{Goal}
Our goal is to calculate the value of
\begin{equation*}
\frac{d^2}{dt^2}\text{Mag}\left(tB_2^d\right)\big\vert_{t=0}.
\end{equation*}
\end{block}

\framebreak

\begin{block}{Outline}
\setbeamertemplate{enumerate items}[square]
\begin{enumerate}
\item Apply the quotient rule to Theorem \ref{thm:willerton} and the result of Theorem \ref{thm:meckesasymp} to express the second derivative in terms of $N(t),D(t)$.
\item The expression will contain first and second derivatives of $N(t)$ and $D(t)$ evaluated at $t = 0$. First consider disjoint $k$-collections containing exactly one flat step to simplify terms containing first derivatives.
\item Consider disjoint $k$-collections containing exactly two flat steps to simplify terms containing second derivatives.
\item Combine the previous two steps to arrive at an (partial) answer.
\end{enumerate}
\end{block}

\end{frame}

\begin{frame}{Second derivative}
After applying the quotient rule, we get
\begin{equation*}
\frac{d^2}{dt^2}\text{Mag}\left(tB_2^d\right)\big\vert_{t=0} = 2\left[\frac{N''(0)-d!D''(0)}{N(0)}\right] - V_1\left(B_2^d\right)\left[\frac{D'(0)}{D(0)}\right].
\end{equation*}
where
\begin{align*}
&D(0) = \omega_0\left(\sigma_\text{roof}^{m-1}\right) = \prod\limits_{k=0}^{m-1}\frac{(2k+1)!}{(k+1)!} \\
&N(0) = \omega_2\left(\sigma_\text{roof}^{m+1}\right) = \prod\limits_{k=0}^{m+1}\frac{(2k-1)!}{(k-1)!}
\end{align*}

\end{frame}

\begin{frame}[allowframebreaks]{Collections with one flat step}

\begin{equation*}
D'(0) = t^{-1}\sum\limits_{\sigma\in X_{m-1}^1}\omega_0(\sigma)
\end{equation*}
So we need to consider disjoint $(m-1)$-collections of Schröder paths containing exactly one flat step.

\framebreak

\begin{figure}
\begin{equation*}
\begin{tikzpicture}[scale=0.75]
\foreach \i in {0,...,6}
	\foreach \j in {0,...,6}{
		\draw (\i,\j) circle(1pt);
	};
	
	% 0 level
	\node at (3,0) [circle, fill, inner sep=1pt]{};
	
	% 1 level
	\node at (2,1) [circle, fill, inner sep=1pt]{};
	\node at (3,1) [circle, fill, inner sep=1pt]{};
	\node at (4,1) [circle, fill, inner sep=1pt]{};
	\draw (2,1) -- (4,1);
	
	% 2 level
	\node at (1,2) [circle, fill, inner sep=1pt]{};
	\node at (2,3) [circle, fill, inner sep=1pt]{};
	\node at (3,2) [circle, fill, inner sep=1pt]{};
	\node at (4,3) [circle, fill, inner sep=1pt]{};
	\node at (5,2) [circle, fill, inner sep=1pt]{};
	\draw (1,2) -- (2,3);
	\draw (2,3) -- node[above] {2} (3,2);
	\draw (3,2) -- (4,3);
	\draw (4,3) -- node[above] {2} (5,2);
	
	% 3 level
	\node at (0,3) [circle, fill, inner sep=1pt]{};
	\node at (1,4) [circle, fill, inner sep=1pt]{};
	\node at (2,5) [circle, fill, inner sep=1pt]{};
	\node at (3,6) [circle, fill, inner sep=1pt]{};
	\node at (4,5) [circle, fill, inner sep=1pt]{};
	\node at (5,4) [circle, fill, inner sep=1pt]{};
	\node at (6,3) [circle, fill, inner sep=1pt]{};
	\draw (0,3) -- (1,4) -- (2,5) -- (3,6);
	\draw (3,6) -- node[above] {5} (4,5);
	\draw (4,5) -- node[above] {4} (5,4);
	\draw (5,4) -- node[above] {3} (6,3);
\end{tikzpicture}
\end{equation*}
\caption{\label{fig:Mpath} A disjoint 3-collection containing a flat step at height 1 and an M-path at height 2 with $\omega_2$ weightings.}
\end{figure}

\framebreak

\begin{itemize}
\item Let $\sigma \in X_{k}^1$ with path containing flat step at height $p$.
\item All paths below $p$ must be V-paths.
\item The disjointness condition means the flat step at height $p$ must be centered.
\item Paths above the flat step path \text{M-paths} or V-paths.
\item Cannot have V-paths below M-paths.
\end{itemize}

\begin{lemma}\label{lem:X1}
Let $\sigma^{m-1}_{p,q}$ denote the disjoint $(m-1)$-collection with centered flat step at height $p$ and $q$ M-paths above it. Then
\begin{equation*}
X_{m-1}^1 = \bigcup\limits_{\substack{1\leq p \leq m-1 \\ 0\leq q \leq m - 1 -p}} \sigma^{m-1}_{p,q}.
\end{equation*}
\end{lemma}

\framebreak

By Lemma \ref{lem:X1} above, we have
\begin{align*}
D'(0) &= \sum\limits_{\substack{1\leq p\leq m-1\\0\leq q\leq m-1-p}}\left(\prod\limits_{k=0}^{p-1}\frac{(2k+1)!}{(k+1)!}\right)\left(\frac{(2p)!}{(p+1)!}\right) \times \\
&\qquad \left(\prod\limits_{k=p+1}^{p+q}\frac{(2k)!(2k)}{(k+1)!}\right)\left(\prod\limits_{k=p+q+1}^{m-1}\frac{(2k+1)!}{(k+1)!}\right).
\end{align*}

So we have
\begin{equation*}\label{eqn:D'/D}
\frac{D'(0)}{D(0)} = \sum\limits_{\substack{1\leq p \leq m-1 \\ 0 \leq q \leq m - 1 - p}}\frac{1}{2p+1}\prod\limits_{k=p+1}^{p+q}\left(\frac{2k}{2k+1}\right).
\end{equation*}

\end{frame}

\begin{frame}[allowframebreaks]{Collections with two flat steps}

\begin{itemize}
\item The $N''(0)-d!D''(0)$ term requires us to think about collections containing exactly two flat steps.
\item Again, all paths underneath the one containing flat step(s) must be V-paths.
\item But then this means that we can't have one path containing two flat steps.
\item Furthermore, the path containing the first flat step must have its flat step centered.
\item We can have M-paths above the first flat step path.
\item Second flat step can either be centered, or offset by one space to the left or right.
\end{itemize}

\framebreak

\begin{columns}
\begin{column}{0.45\textwidth}
\begin{itemize}
\item Above an off-centered flat step, we can have \textbf{asymmetric M-paths} followed by M-paths and then followed by V-paths.
\item By symmetry, the weightings on the left offset case and the right offset case are the same, so only need to consider one.
\end{itemize}
\end{column}
\begin{column}{0.45\textwidth}
\begin{figure}
\begin{equation*}
\begin{tikzpicture}[scale=0.50]
\foreach \i in {0,...,6}
	\foreach \j in {0,...,6}{
		\draw (\i,\j) circle(1pt);
	};
	
	% 0 level
	\node at (3,0) [circle, fill, inner sep=1pt]{};
	
	% 1 level
	\node at (2,1) [circle, fill, inner sep=1pt]{};
	\node at (3,1) [circle, fill, inner sep=1pt]{};
	\node at (4,1) [circle, fill, inner sep=1pt]{};
	\draw (2,1) -- (4,1);
	
	% 2 level
	\node at (1,2) [circle, fill, inner sep=1pt]{};
	\node at (2,3) [circle, fill, inner sep=1pt]{};
	\node at (3,2) [circle, fill, inner sep=1pt]{};
	\node at (4,2) [circle, fill, inner sep=1pt]{};
	\node at (5,2) [circle, fill, inner sep=1pt]{};
	\draw (1,2) -- (2,3);
	\draw (2,3) -- node[above] {2} (3,2);
	\draw (3,2) -- (4,2) -- (5,2);
	
	% 3 level
	\node at (0,3) [circle, fill, inner sep=1pt]{};
	\node at (1,4) [circle, fill, inner sep=1pt]{};
	\node at (2,5) [circle, fill, inner sep=1pt]{};
	\node at (3,4) [circle, fill, inner sep=1pt]{};
	\node at (4,3) [circle, fill, inner sep=1pt]{};
	\node at (5,4) [circle, fill, inner sep=1pt]{};
	\node at (6,3) [circle, fill, inner sep=1pt]{};
	\draw (0,3) -- (1,4) -- (2,5);
	\draw (2,5) -- node[above] {4} (3,4);
	\draw (3,4) -- node[above] {3} (4,3);
	\draw (4,3) -- (5,4);
	\draw (5,4) -- node[above] {3} (6,3);
\end{tikzpicture}
\end{equation*}
\caption{\label{fig:asymMpath} A disjoint 3-collection containing two flat steps (one off-centered) and an asymmetric M-path with $\omega_2$ weightings.}
\end{figure}
\end{column}
\end{columns}

\framebreak

\begin{itemize}
\item Denote by $\sigma^k_{p_1,p_2,q_1,q_2}$ the disjoint $k$-collection with two centered flat step paths at heights $p_1$ and $p_2$ respectively, $q_1$ M-paths above the first flat step, $q_2$ M-paths above the second flat step, and V-paths everywhere else.
\item Denote by $L^k_{p_1,p_2,q_1,q_2}$ the disjoint $k$-collection with two flat step paths at heights $p_1$ and $p_2$ respectively where the flat step at $p_2$ is offset one to the left, M-paths between $p_1$ and $p_2$, $q_1$ asymmetric (left) M-paths above $p_2$, $q_2$ M-paths above $p_2+q_1$ and V-paths everywhere else.
\item $R^k_{p_1,p_2,q_1,q_2}$: The same as $L^k_{p_1,p_2,q_1,q_2}$ but the right offset case.
\end{itemize}
Then
\begin{equation*}
X_k^2 = \bigcup\limits_{p_1,p_2,q_1,q_2}\sigma_{p_1,p_2,q_1,q_2}^k \cup \bigcup\limits_{p_1,p_2,q_1,q_2}L_{p_1,p_2,q_1,q_2}^k \cup \bigcup\limits_{p_1,p_2,q_1,q_2}R_{p_1,p_2,q_1,q_2}^k.
\end{equation*}

\framebreak

\begin{itemize}
\item $N''(0)-d!D''(0)$ means we will have to consider both $X_{m-1}^2$ as well as $X_{m+1}^2$.
\item Can apply a trick of thinking of collections in $X_{m-1}$ as being embedded in $X_{m+1}$.
\end{itemize}

\begin{lemma}[Willerton]
Let $d = 2m+1$ and $\sigma \in X_{m-1}$. Then define $\mu(\sigma)\in X_{m+1}$ by shifting all paths in $\sigma$ up two units, adding ascents from $(-i,i)$ to $(-i+1,i+1)$ and descents from $(i-1,i+1)$ to $(i,i)$ for $1\leq i \leq m$ and finally adding a V-path at height $m+1$. Then
\begin{equation*}
\omega_2(\mu(\sigma)) = d!\omega_0(\sigma).
\end{equation*}
\end{lemma}

\framebreak

\begin{itemize}
\item So we only need to consider those paths in $X_{m+1}^2$ that are not $\mu$-embeddings of paths from $X_{m-1}^2$, that is,
\begin{equation*}
N''(0)-d!D''(0) = t^{-2}\sum\limits_{\sigma\in X_{m+1}^2\setminus\mu(X_{m-1}^2)}\omega_2(\sigma).
\end{equation*}
\end{itemize}

\framebreak

There are four disjoint cases:
\begin{itemize}
\item The first flat step at height $p_1=1$ and the second flat step is at height $p_2$ where $2\leq p_2\leq m+1$.
\item The first flat step is at height $p_1 \geq 2$. The second flat step is at height $p_2 = m$ and we either have a M-path or an asymmetric M-path above $p_2$.
\item The first flat step is at height $p_1 \geq 2$. The second flat step is at height $p_2 = m+1$.
\item The two flat steps are at heights between $2$ and $m-1$ but with no V-paths above height $p_2$.
\end{itemize}

\framebreak

\begin{itemize}
\item Actually we need to multiply the number of cases above by two because we need to consider case where the two flat steps are centered ($\sigma$) and the case where the second flat step is offset to the left ($L$).
\item Don't need to consider the right offset case by symmetry.
\item But actually it turns out that the total weights for both cases is the same! So we only need to consider the $\sigma$ case.
\item After a lot of simplifying, we get...
\end{itemize}

\end{frame}

\begin{frame}{Partial results I}

Let $d=2m+1$ be odd and $B_2^d$ be the closed $d$-dimensional Euclidean ball. Then
\scriptsize
\begin{align*}
&\frac{d^2}{dt^2}\text{Mag}(tB_2^d)\big\vert_{t=0} = \\
&6\sum\limits_{\substack{2\leq p_2\leq m+1 \\ 0\leq q_1 \leq p_2-2 \\ 0\leq q_2 \leq m+1-p_2}}\frac{1}{2p_2-1}\left(\prod\limits_{k=2}^{q_1+2}\frac{(2k-2)}{(2k-1)}\right)\left(\prod\limits_{k=p_2+1}^{p_2+q_2}\frac{(2k-2)}{(2k-1)}\right) + \\
&6\sum\limits_{\substack{2\leq p_1\leq m-1 \\ 0\leq q_1\leq m-p_1-1}}\frac{1}{2p_1-1}\left(\prod\limits_{k=p_1+1}^{p_1+q_1}\frac{(2k-2)}{(2k-1)}\right)\left(\frac{2m}{(2m-1)(2m+1)}\right) + \\
&6\sum\limits_{\substack{2\leq p_1\leq m \\ 0\leq q_1\leq m-p_1}}\frac{1}{2p_1-1}\left(\prod\limits_{k=p_1+1}^{p_1+q_1}\frac{(2k-2)}{(2k-1)}\right)\left(\frac{1}{2m+1}\right) + \\
&6\sum\limits_{\substack{2\leq p_1\leq m \\ p_1+1\leq p_2 \leq m-1 \\ 0\leq q_1\leq p_2-p_1-1 }}\frac{1}{2p_1-1}\left(\prod\limits_{k=p_1+1}^{p_1+q_1}\frac{(2k-2)}{(2k-1)}\right)\frac{1}{2p_2-1}\left(\prod\limits_{k=p_2+1}^{m+1}\frac{(2k-2)}{(2k-1)}\right) - \\
&V_{1}\sum\limits_{\substack{1\leq p \leq m-1 \\ 0 \leq q \leq m - 1 - p}}\frac{1}{2p+1}\prod\limits_{k=p+1}^{p+q}\left(\frac{2k}{2k+1}\right).
\end{align*}
\normalsize

\end{frame}

\begin{frame}{Partial results II}
\begin{figure}
\centerline{\includegraphics[width=9cm]{secs.eps}}\caption{\label{fig:secondsplot} Second order terms computed for odd dimensions from 1 to 41.}
\end{figure}
\end{frame}

\begin{frame}{Future work}
\begin{itemize}
\item Continue trying to simplify the long expression for the second derivative term (skip factorials, Catalan numbers,...)
\end{itemize}
\end{frame}

\begin{frame}[plain]
\centerline{Questions?}
\end{frame}

\begin{frame}[plain]
\centerline{Thank you for listening!}
\end{frame}

\begin{frame}[allowframebreaks]{References}
\frametitle{References}
\nocite{*}
\bibliographystyle{amsalpha}
\bibliography{refs.bib}
\end{frame}

\end{document}